SELECT 
  DISTINCT 
  CASE 
    WHEN UPPER(m.exrf_cod_tip_doc) = 'CC' THEN '01'
    WHEN UPPER(m.exrf_cod_tip_doc) = 'CE' THEN '02'
    WHEN UPPER(m.exrf_cod_tip_doc) IN ('NIT', 'NI', 'NT') THEN '03'
    ELSE '01'
  END AS Tipo_identificacion,
  m.exrf_num_id_cliente AS Numero_de_identificacion,
  -- Tipo de cliente según el nuevo tipo de identificación
  CASE 
    WHEN 
      CASE 
        WHEN UPPER(m.exrf_cod_tip_doc) = 'CC' THEN '01'
        WHEN UPPER(m.exrf_cod_tip_doc) = 'CE' THEN '02'
        WHEN UPPER(m.exrf_cod_tip_doc) IN ('NIT', 'NI', 'NT') THEN '03'
        ELSE '01'
      END = '03' THEN 'Persona Jurídica'
    ELSE 'Persona Natural'
  END AS Tipo_de_Cliente

FROM 
  dc_ext_revisoria_fiscal m;
