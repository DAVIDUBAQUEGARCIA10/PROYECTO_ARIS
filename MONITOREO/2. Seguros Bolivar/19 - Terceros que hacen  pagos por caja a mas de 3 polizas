SELECT 
    TIPO_DOCUMENTO_TOMADOR,
    NUMERO_DOCUMENTO_TOMADOR,
    COUNT(DISTINCT NUMERO_POLIZA) AS cantidad_polizas
FROM 
    `sb-ecosistemaanalitico-lago.datamart.t_produccion_recaudo_diario`
GROUP BY 
    TIPO_DOCUMENTO_TOMADOR,
    NUMERO_DOCUMENTO_TOMADOR
HAVING 
    COUNT(DISTINCT NUMERO_POLIZA) > 3;  -- Filtrar tomadores con más de 3 pólizas
