SELECT DISTINCT
    c.NUMERO_SECUENCIA_POLIZA,
    c.TIPO_DOCUMENTO,
    c.KEY_ID,
    c.NOMBRE,
    c.NOMBRE_COMERCIAL,
    c.SECTOR_ECONOMICO,
    c.ACTIVIDAD_ECONOMICA,
    c.CODIGO_CIIU,
    p.codigo_ramo_emision,
    p.nombre_ramo_emision,
    p.codigo_producto,
    p.nombre_producto,
    DATE(c.FECHA_NACIMIENTO) AS FECHA_NACIMIENTO,
    c.GRAN_CONTRIBUYENTE,
    c.VALOR_EGRESOS,
    c.VALOR_INGRESOS,
    c.VALOR_ACTIVO,
    c.VALOR_PASIVO,
    c.VALOR_PATRIMONIO,
    DATE(c.FECHA_ACTUALIZACION) AS FECHA_ACTUALIZACION,
    p.CODIGO_COMPANIA,
    p.NUMERO_POLIZA,
    p.KEY_ID_ASEGURADO,
    DATE(p.FECHA_FIN_ENDOSO) AS FECHA_FIN_ENDOSO,
    DATE(p.FECHA_FIN_POLIZA) AS FECHA_FIN_POLIZA,
    p.VALOR_ASEGURADO
FROM 
    `sb-ecosistemaanalitico-lago.seguros_bolivar.t_clientes_juridicos` c
JOIN 
    `sb-ecosistemaanalitico-lago.seguros_bolivar.t_polizas_riesgos_endosos` p
    ON c.KEY_ID = p.KEY_ID_TOMADOR
WHERE 
    c.FECHA_NACIMIENTO IS NOT NULL
    AND DATE(p.FECHA_FIN_ENDOSO) > CURRENT_DATE()
    AND DATE(p.FECHA_FIN_POLIZA) > CURRENT_DATE()
    AND p.VALOR_ASEGURADO > 16000000
    AND DATE(c.FECHA_NACIMIENTO) > DATE_SUB(CURRENT_DATE(), INTERVAL 2 YEAR)
    AND CODIGO_COMPANIA = 2;
